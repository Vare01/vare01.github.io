<!DOCTYPE html>
<html lang="sr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shocking Math | Human Metrics Hub</title>
    <style>
        :root {
            --primary: #00ff88;
            --bg: #0b0f1a;
            --card: #161b2a;
            --text: #f8fafc;
            --sidebar-w: 280px;
            --accent: #3b82f6;
        }

        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: var(--bg);
            color: var(--text);
            margin: 0;
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* Sidebar - Desktop */
        .sidebar {
            width: var(--sidebar-w);
            background: var(--card);
            border-right: 1px solid #2d334a;
            display: flex; flex-direction: column;
            padding: 25px; flex-shrink: 0; z-index: 100;
        }

        .logo-container {
            margin-bottom: 25px;
        }

        .logo {
            font-size: 1.4rem; font-weight: 900; color: var(--primary);
            letter-spacing: -1px;
            display: flex; align-items: center; gap: 10px;
        }

        .beta-tag {
            font-size: 0.65rem;
            background: rgba(255, 255, 255, 0.1);
            color: #94a3b8;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
            margin-top: 4px;
            display: inline-block;
        }

        .search-box {
            padding: 12px; background: var(--bg); border: 1px solid #2d334a;
            border-radius: 10px; color: white; margin-bottom: 20px;
            width: 100%; box-sizing: border-box; outline: none; font-size: 0.85rem;
        }

        .nav-list {
            list-style: none; padding: 0; margin: 0;
            overflow-y: auto; flex-grow: 1;
        }

        .nav-item {
            padding: 10px 14px; border-radius: 10px; cursor: pointer;
            margin-bottom: 6px; transition: all 0.2s ease;
            font-size: 0.85rem; color: #94a3b8;
            display: flex; align-items: center; gap: 10px;
        }

        .nav-item:hover { background: rgba(0, 255, 136, 0.05); color: white; }
        .nav-item.active {
            background: var(--primary); color: #000; font-weight: 700;
        }

        /* Mobile Header */
        .mobile-header {
            display: none;
            width: 100%;
            background: var(--card);
            padding: 10px 15px;
            border-bottom: 1px solid #2d334a;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1000;
            box-sizing: border-box;
            flex-direction: column;
            gap: 5px;
        }

        .mobile-top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }

        .mobile-tool-select {
            background: var(--bg);
            color: var(--primary);
            border: 1px solid var(--primary);
            padding: 10px;
            border-radius: 10px;
            font-size: 0.95rem;
            outline: none;
            width: 100%;
            font-weight: 600;
        }

        /* Main Content */
        .main-content {
            flex-grow: 1; display: flex; flex-direction: column;
            align-items: center; justify-content: flex-start;
            padding: 40px 20px; overflow-y: auto; position: relative;
        }

        .lang-bar {
            display: flex; gap: 5px;
        }

        /* Desktop position for lang-bar */
        .sidebar .lang-bar {
            margin-top: auto;
            padding-top: 20px;
            border-top: 1px solid #2d334a;
        }

        .lang-btn {
            background: var(--card); border: 1px solid #2d334a; color: white;
            padding: 6px 10px; border-radius: 8px; cursor: pointer;
            font-size: 0.75rem; font-weight: 600; flex: 1;
            text-align: center;
        }

        .lang-btn.active { border-color: var(--primary); color: var(--primary); background: rgba(0, 255, 136, 0.1); }

        .tool-card {
            background: var(--card); padding: 30px; border-radius: 24px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.4); width: 100%;
            max-width: 600px; border: 1px solid #2d334a;
            margin-bottom: 40px;
        }

        h2 { margin: 0 0 10px 0; font-size: 1.5rem; display: flex; align-items: center; gap: 10px; }
        .tool-desc { color: #64748b; font-size: 0.85rem; margin-bottom: 25px; line-height: 1.4; }

        .input-row { display: flex; gap: 15px; margin-bottom: 15px; flex-wrap: wrap; }
        .input-group { flex: 1; min-width: 140px; }

        label {
            display: block; margin-bottom: 8px; font-size: 0.7rem;
            color: #64748b; text-transform: uppercase; font-weight: 800;
        }

        input, select {
            width: 100%; padding: 12px; background: var(--bg);
            border: 1px solid #2d334a; border-radius: 10px; color: white;
            font-size: 0.95rem; box-sizing: border-box;
        }

        input:focus, select:focus { border-color: var(--primary); outline: none; }

        .calc-btn {
            width: 100%; padding: 16px; background: var(--primary);
            color: #000; border: none; border-radius: 12px; font-weight: 800;
            cursor: pointer; text-transform: uppercase; font-size: 0.9rem; margin-top: 10px;
        }

        .ai-btn {
            background: var(--accent); color: white; padding: 18px;
            border-radius: 14px; font-weight: 800; border: none; cursor: pointer;
            display: flex; align-items: center; justify-content: center; gap: 12px; 
            margin-top: 20px; width: 100%; font-size: 1.1rem;
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.3);
            transition: transform 0.2s ease;
        }

        .ai-btn:active { transform: scale(0.98); }

        .result-container { margin-top: 30px; display: none; width: 100%; }
        .res-block {
            background: rgba(255,255,255,0.02); border-radius: 16px;
            padding: 18px; margin-bottom: 12px; border: 1px solid rgba(255,255,255,0.05);
        }

        .ai-block {
            background: rgba(59, 130, 246, 0.05); border: 1px solid var(--accent);
            border-left-width: 4px; padding: 18px; border-radius: 16px;
            margin-top: 15px; display: none;
        }

        .res-title { color: var(--primary); font-size: 0.65rem; font-weight: 900; text-transform: uppercase; margin-bottom: 5px; display: block; }
        .res-value { font-size: 1rem; font-weight: 500; line-height: 1.5; }
        .highlight { color: var(--primary); font-weight: 800; }

        .spinner {
            width: 22px; height: 22px; border: 3px solid rgba(255,255,255,0.3);
            border-top: 3px solid white; border-radius: 50%; animation: spin 1s linear infinite; display: none;
        }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        /* Responsive UI */
        @media (max-width: 850px) {
            .sidebar { display: none; }
            .mobile-header { display: flex; }
            .main-content { padding-top: 140px; padding-left: 15px; padding-right: 15px; height: auto; overflow: visible; }
            body { height: auto; overflow-y: auto; }
            .tool-card { padding: 20px; margin-top: 0; }
        }
    </style>
</head>
<body>

    <!-- Mobile Header -->
    <header class="mobile-header">
        <div class="mobile-top-bar">
            <div class="logo-container">
                <div class="logo" style="margin:0; font-size: 1rem;">SHOCKING MATH ‚ö°</div>
                <div class="beta-tag">BETA v1.0</div>
            </div>
            <div class="lang-bar" id="mobile-lang-bar">
                <button class="lang-btn active" onclick="changeLang('en')">EN</button>
                <button class="lang-btn" onclick="changeLang('sr')">SR</button>
            </div>
        </div>
        <select class="mobile-tool-select" id="mobile-nav" onchange="selectMobileTool(this.value)"></select>
    </header>

    <!-- Desktop Sidebar -->
    <aside class="sidebar">
        <div class="logo-container">
            <div class="logo">SHOCKING MATH ‚ö°</div>
            <div class="beta-tag">BETA v1.0</div>
        </div>
        <input type="text" class="search-box" id="search" placeholder="Pretra≈æi..." onkeyup="filterTools()">
        <ul class="nav-list" id="nav-list"></ul>
        <div class="lang-bar">
            <button class="lang-btn active" onclick="changeLang('en')">EN</button>
            <button class="lang-btn" onclick="changeLang('sr')">SR</button>
        </div>
    </aside>

    <main class="main-content">
        <div id="tool-view" style="width: 100%; display: flex; justify-content: center;"></div>
    </main>

<script>
    let activeLang = 'en';
    let activeTool = "lifestyle";

    const toolDefinitions = [
        { id: "lifestyle", emoji: "üß™", inputs: ["age", "smoke", "packs", "smoke_start", "drink", "alcohol_freq", "drink_start", "diet", "no_pork"] },
        { id: "human", emoji: "üë§", inputs: ["age"] },
        { id: "oxygen", emoji: "üå¨Ô∏è", inputs: ["age"] },
        { id: "scroll", emoji: "üì±", inputs: ["age", "start", "hours"] },
        { id: "coffee", emoji: "‚òï", inputs: ["age", "start", "daily"] },
        { id: "perfume", emoji: "üß¥", inputs: ["size", "price", "sprays", "freq"] },
        { id: "exam", emoji: "üìö", inputs: ["pages", "pph", "hours"] },
        { id: "toilet", emoji: "üöΩ", inputs: ["min", "daily"] },
        { id: "sleep", emoji: "üò¥", inputs: ["shours"] },
        { id: "books", emoji: "üìñ", inputs: ["pday"] },
        { id: "bezos", emoji: "üí∞", inputs: ["salary"] },
        { id: "pizza", emoji: "üçï", inputs: ["monthly"] },
        { id: "commute", emoji: "üöó", inputs: ["chours", "cyears"] },
        { id: "words", emoji: "üó£Ô∏è", inputs: ["age"] },
        { id: "sitting", emoji: "ü™ë", inputs: ["shours_day", "syears"] },
        { id: "waiting", emoji: "‚è≥", inputs: ["age"] }
    ];

    const translations = {
        en: {
            nav: ["Lifestyle Quiz", "Human Body Stats", "Oxygen Factory", "Scroll Everest", "Coffee Ocean", "Perfume Value", "Exam Timer", "Toilet Warp", "Sleep Debt", "Book Worm", "Bezos vs You", "Pizza Surface", "Commute Life", "Words Library", "Sitting Life", "Waiting Line"],
            h: ["Lifestyle Shock Quiz", "Human Body Facts", "Oxygen Factory", "Scroll Distance", "Coffee Ocean", "Perfume Value", "Exam Prep", "Toilet Time", "Sleep Debt", "Book Worm", "The Bezos Gap", "Pizza Surface", "Traffic Trap", "Talking Library", "The Chair Trap", "Queue Specialist"],
            d: ["Calculate the true impact of your habits.", "Biological impact of your existence.", "Amount of oxygen you've consumed and CO2 produced.", "Vertical distance you've scrolled.", "The literal ocean of caffeine consumed.", "True cost of smelling good.", "Study sessions based on volume.", "Life spent on the porcelain throne.", "Cost of staying awake vs rest.", "Knowledge volume in books.", "Billionaire vs your annual wage.", "Total surface of dough eaten.", "Time lost in traffic jams.", "Library of words you've spoken.", "Impact of a sedentary lifestyle.", "Time spent waiting in queues."],
            lbl: {
                age: "Age", smoke: "Smoker?", packs: "Packs/Day", smoke_start: "Smoking since age",
                drink: "Drinker?", alcohol_freq: "Drinks/Week", drink_start: "Drinking since age",
                diet: "Diet Type", no_pork: "No Pork?",
                start: "Started at", hours: "Hours/Day", daily: "Times/Day", size: "Size (ml)", price: "Price (‚Ç¨)",
                sprays: "Sprays", freq: "Days/Week", pages: "Pages", pph: "Pages/h", min: "Min/Session",
                shours: "Sleep Hours", pday: "Pages/Day", monthly: "Pizzas/Month", salary: "Salary (‚Ç¨)", 
                chours: "Hours/Day", cyears: "Years", shours_day: "Hours Sitting", syears: "Years",
                btn: "Calculate üöÄ", ai_btn: "Get ‚ú® AI Insight", ai_loading: "Analyzing...", ai_title: "AI Analysis ‚ú®",
                soon: "Feature coming soon! üöÄ",
                opt_yes: "Yes", opt_no: "No", opt_normal: "Normal", opt_vegan: "Vegan", opt_veg: "Vegetarian"
            },
            res_t: ["The Shock üò±", "The Math üìä"],
            facts: ["Heartbeat", "Breaths", "Hair", "Feces", "Urine", "Skin"],
            units: ["beats", "times", "km", "kg", "L", "kg"],
            ofacts: ["Oxygen Consumed", "CO2 Produced", "Trees Required"],
            ounits: ["liters", "kg", "trees"],
            life_res: ["Smoking", "Alcohol", "Diet"]
        },
        sr: {
            nav: ["≈Ωivotni kviz", "Ljudsko telo", "Fabrika kiseonika", "Scroll Everest", "Okean kafe", "Cena parfema", "Ispit tajmer", "WC vreme", "Dug spavanja", "ƒåitaƒç knjiga", "Bezos i ti", "Povr≈°ina pice", "≈Ωivot u putu", "Biblioteka reƒçi", "≈Ωivot u stolici", "Red ƒçekanja"],
            h: ["≈†ok kviz navika", "ƒåinjenice o telu", "Fabrika kiseonika", "Scroll kilometra≈æa", "Okean kafe", "Vrednost parfema", "Spremanje ispita", "WC vremenska ma≈°ina", "Dug spavanja", "ƒåitaƒç knjiga", "Bezosov ponor", "Povr≈°ina pice", "Zemlja u gu≈ævi", "Govorna biblioteka", "Zamka stolice", "Specijalista za redove"],
            d: ["Izraƒçunaj pravi uticaj tvojih svakodnevnih navika.", "Izraƒçunaj svoj biolo≈°ki uticaj do sada.", "Koliƒçina kiseonika koju si potro≈°io i CO2 koji si proizveo.", "Koliko si visoko skrolovao vertikalno.", "Doslovni okean kofeina koji si popio.", "Prava cena tvog dobrog mirisa.", "Isplaniraj uƒçenje na osnovu strana.", "Vreme provedeno na porcelanskom tronu.", "Cena nespavanja u odnosu na odmor.", "Zapremina znanja u knjigama.", "Koliko brzo Bezos zaradi tvoju platu.", "Ukupna povr≈°ina testa koju si pojeo.", "Vreme izgubljeno u saobraƒáaju.", "Biblioteka reƒçi koje si izgovorio.", "Fiziƒçki uticaj sedenja.", "Vreme provedeno u redovima."],
            lbl: {
                age: "Godine", smoke: "Pu≈°aƒç?", packs: "Pakli dnevno", smoke_start: "Pu≈°i≈° od god.",
                drink: "Pije≈°?", alcohol_freq: "Piƒáa nedeljno", drink_start: "Pije≈° od god.",
                diet: "Ishrana", no_pork: "Bez svinjetine?",
                start: "Poƒçeo sa", hours: "Sati dnevno", daily: "Dnevno puta", size: "Veliƒçina (ml)", price: "Cena (‚Ç¨)",
                sprays: "Prskanja", freq: "Dana/Nedeljno", pages: "Ukupno strana", pph: "Strana/h", min: "Min/Sesiji",
                shours: "Sati sna", pday: "Strana/Dan", monthly: "Pica meseƒçno", salary: "Plata (‚Ç¨)",
                chours: "Sati/Dan", cyears: "Godina puta", shours_day: "Sati sedenja", syears: "Godina sedenja",
                btn: "Izraƒçunaj üöÄ", ai_btn: "Zatra≈æi ‚ú® AI Uvid", ai_loading: "Analiziram...", ai_title: "AI Analiza ‚ú®",
                soon: "Funkcija sti≈æe uskoro! üöÄ",
                opt_yes: "Da", opt_no: "Ne", opt_normal: "Normalna", opt_vegan: "Vegan", opt_veg: "Vegetarijanac"
            },
            res_t: ["≈†ok podatak üò±", "Matematika üìä"],
            facts: ["Otkucaji srca", "Udisaji", "Rast kose", "Izmet", "Urin", "Mrtva ko≈æa"],
            units: ["otkucaja", "puta", "km", "kg", "L", "kg"],
            ofacts: ["Potro≈°en kiseonik", "Proizveden CO2", "Potrebno drveƒáa"],
            ounits: ["litara", "kg", "stabala"],
            life_res: ["Pu≈°enje", "Alkohol", "Ishrana"]
        }
    };

    function formatNumber(n) {
        return new Intl.NumberFormat('de-DE').format(Math.floor(n));
    }

    function handleInput(e) {
        if (e.target.tagName === 'SELECT') return;
        let val = e.target.value.replace(/\D/g, "");
        if (val === "") { e.target.value = ""; return; }
        e.target.value = new Intl.NumberFormat('de-DE').format(parseInt(val));
    }

    function getRawValue(id) {
        const el = document.getElementById(id);
        if (!el) return 0;
        if (el.tagName === 'SELECT') return el.value;
        return parseFloat(el.value.replace(/\./g, "")) || 0;
    }

    function changeLang(l) {
        activeLang = l;
        document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.lang-btn').forEach(b => {
            if (b.innerText.toLowerCase() === l) b.classList.add('active');
        });
        refreshSidebar();
        renderActiveTool();
    }

    function selectMobileTool(val) {
        activeTool = val;
        refreshSidebar();
        renderActiveTool();
    }

    function refreshSidebar(filter = "") {
        const d = translations[activeLang] || translations['en'];
        const list = document.getElementById('nav-list');
        const mobileNav = document.getElementById('mobile-nav');
        
        list.innerHTML = "";
        mobileNav.innerHTML = "";

        toolDefinitions.forEach((tool, i) => {
            const name = d.nav[i];
            if (name.toLowerCase().includes(filter.toLowerCase())) {
                const li = document.createElement('li');
                li.className = `nav-item ${tool.id === activeTool ? 'active' : ''}`;
                li.innerHTML = `<span>${tool.emoji}</span> ${name}`;
                li.onclick = () => { activeTool = tool.id; refreshSidebar(filter); renderActiveTool(); };
                list.appendChild(li);
            }
            const opt = document.createElement('option');
            opt.value = tool.id;
            opt.innerText = `${tool.emoji} ${name}`;
            opt.selected = tool.id === activeTool;
            mobileNav.appendChild(opt);
        });
    }

    function renderActiveTool() {
        const toolIdx = toolDefinitions.findIndex(t => t.id === activeTool);
        const tool = toolDefinitions[toolIdx];
        const d = translations[activeLang] || translations['en'];
        const view = document.getElementById('tool-view');
        
        let inputsHtml = "";
        for (let i = 0; i < tool.inputs.length; i++) {
            const key = tool.inputs[i];
            
            if (i % 2 === 0) inputsHtml += '<div class="input-row">';
            
            if (["smoke", "drink", "no_pork"].includes(key)) {
                inputsHtml += `<div class="input-group"><label>${d.lbl[key]}</label><select id="in-${key}"><option value="yes">${d.lbl.opt_yes}</option><option value="no">${d.lbl.opt_no}</option></select></div>`;
            } else if (key === "diet") {
                inputsHtml += `<div class="input-group"><label>${d.lbl[key]}</label><select id="in-${key}"><option value="normal">${d.lbl.opt_normal}</option><option value="vegan">${d.lbl.opt_vegan}</option><option value="veg">${d.lbl.opt_veg}</option></select></div>`;
            } else {
                inputsHtml += `<div class="input-group"><label>${d.lbl[key]}</label><input type="text" id="in-${key}" value="${formatNumber(getDefaultValue(key))}" oninput="handleInput(event)"></div>`;
            }

            if (i % 2 === 1 || i === tool.inputs.length - 1) inputsHtml += '</div>';
        }

        view.innerHTML = `
            <div class="tool-card active">
                <h2>${tool.emoji} ${d.h[toolIdx]}</h2>
                <p class="tool-desc">${d.d[toolIdx]}</p>
                ${inputsHtml}
                <button class="calc-btn" onclick="runCalculation()">${d.lbl.btn}</button>
                <div class="result-container" id="res-box"></div>
            </div>
        `;
    }

    function getDefaultValue(key) {
        const defaults = { age: 25, packs: 1, smoke_start: 18, alcohol_freq: 5, drink_start: 18, start: 14, hours: 4, daily: 2, size: 100, price: 150, sprays: 5, freq: 7, pages: 300, pph: 6, min: 20, shours: 6, pday: 25, monthly: 4, salary: 45000, chours: 1, cyears: 15, shours_day: 8, syears: 10 };
        return defaults[key] || 0;
    }

    function runCalculation() {
        const d = translations[activeLang] || translations['en'];
        const vals = {};
        const tool = toolDefinitions.find(t => t.id === activeTool);
        tool.inputs.forEach(id => { vals[id] = getRawValue(`in-${id}`); });

        if (activeTool === 'human') {
            const age = vals.age || 1;
            const facts = [
                { icon: "‚ù§Ô∏è", label: d.facts[0], value: formatNumber(age * 365.25 * 24 * 60 * 75), unit: d.units[0] },
                { icon: "üå¨Ô∏è", label: d.facts[1], value: formatNumber(age * 365.25 * 24 * 60 * 14), unit: d.units[1] },
                { icon: "üíá", label: d.facts[2], value: (age * 365.25 * 0.35 * 100000 / 1000000).toFixed(1), unit: d.units[2] },
                { icon: "üí©", label: d.facts[3], value: formatNumber(age * 365.25 * 0.128), unit: d.units[3] },
                { icon: "üß™", label: d.facts[4], value: formatNumber(age * 365.25 * 1.5), unit: d.units[4] },
                { icon: "üêç", label: d.facts[5], value: (age * 0.8).toFixed(1), unit: d.units[5] }
            ];
            renderHumanResults(facts);
            return;
        }

        if (activeTool === 'oxygen') {
            const age = vals.age || 1;
            const co2 = age * 365.25 * 1.0;
            const facts = [
                { icon: "ü´Å", label: d.ofacts[0], value: formatNumber(age * 365.25 * 550), unit: d.ounits[0] },
                { icon: "üè≠", label: d.ofacts[1], value: formatNumber(co2), unit: d.ounits[1] },
                { icon: "üå≥", label: d.ofacts[2], value: formatNumber(Math.ceil(co2 / 22)), unit: d.ounits[2] }
            ];
            renderHumanResults(facts);
            return;
        }

        if (activeTool === 'lifestyle') {
            const res = [];
            const age = vals.age || 1;

            if (vals.smoke === 'yes') {
                const sYears = Math.max(0, age - vals.smoke_start);
                const totalCigs = sYears * 365.25 * vals.packs * 20;
                const totalMoney = sYears * 365.25 * vals.packs * 4.5; // Avg 4.5e pack
                res.push({
                    icon: "üö¨", label: d.life_res[0],
                    value: activeLang === 'sr' ? 
                        `Popu≈°eno <span class="highlight">${formatNumber(totalCigs)}</span> cigareta (${formatNumber(totalCigs/20)} pakli). Potro≈°eno oko <span class="highlight">${formatNumber(totalMoney)} ‚Ç¨</span>.` :
                        `Smoked <span class="highlight">${formatNumber(totalCigs)}</span> cigarettes (${formatNumber(totalCigs/20)} packs). Spent approx <span class="highlight">${formatNumber(totalMoney)} ‚Ç¨</span>.`
                });
            }

            if (vals.drink === 'yes') {
                const dYears = Math.max(0, age - vals.drink_start);
                const totalDrinks = dYears * 52 * vals.alcohol_freq;
                const totalLiters = totalDrinks * 0.5; // Avg 0.5l per drink
                res.push({
                    icon: "üç∫", label: d.life_res[1],
                    value: activeLang === 'sr' ?
                        `Popijeno <span class="highlight">${formatNumber(totalDrinks)}</span> piƒáa (~${formatNumber(totalLiters)} litara).` :
                        `Consumed <span class="highlight">${formatNumber(totalDrinks)}</span> drinks (~${formatNumber(totalLiters)} liters).`
                });
            }

            let dietDesc = "";
            const totalMeat = age * 365.25 * 0.2; // Avg 200g meat/day
            if (vals.diet === 'vegan') dietDesc = activeLang === 'sr' ? `Kao vegan, spasio si oko <span class="highlight">${formatNumber(age * 300)}</span> ≈æivotinja.` : `As a vegan, you saved approx <span class="highlight">${formatNumber(age * 300)}</span> animals.`;
            else if (vals.diet === 'veg') dietDesc = activeLang === 'sr' ? `Kao vegetarijanac, po≈°tedeo si <span class="highlight">${formatNumber(age * 150)}</span> ≈æivotinja.` : `As a vegetarian, you spared <span class="highlight">${formatNumber(age * 150)}</span> animals.`;
            else dietDesc = activeLang === 'sr' ? `Pojeo si oko <span class="highlight">${formatNumber(totalMeat)} kg</span> mesa do sada.` : `You ate approx <span class="highlight">${formatNumber(totalMeat)} kg</span> of meat so far.`;

            if (vals.no_pork === 'yes') dietDesc += activeLang === 'sr' ? ` Izbegao si <span class="highlight">~${formatNumber(age * 35)} kg</span> svinjetine.` : ` You avoided <span class="highlight">~${formatNumber(age * 35)} kg</span> of pork.`;

            res.push({ icon: "üçΩÔ∏è", label: d.life_res[2], value: dietDesc });

            renderHumanResults(res);
            return;
        }

        const years = Math.max(0, vals.age - (vals.start || 0));
        // Logic for other tools...
        renderResultsArea(activeTool, activeTool, ["Calculation processed.", "Results ready."]);
    }

    function renderHumanResults(data) {
        const container = document.getElementById(`res-box`);
        container.innerHTML = "";
        data.forEach(item => {
            const div = document.createElement('div');
            div.className = "res-block";
            div.style.display = "flex"; div.style.alignItems = "center"; div.style.gap = "15px";
            div.innerHTML = `<span style="font-size: 1.5rem;">${item.icon}</span><div><span class="res-title">${item.label}</span><div class="res-value">${item.value} ${item.unit || ''}</div></div>`;
            container.appendChild(div);
        });
        addAIBtn(container);
        container.style.display = "block";
    }

    function renderResultsArea(id, type, dataStrings) {
        const container = document.getElementById(`res-box`);
        const d = translations[activeLang] || translations['en'];
        container.innerHTML = "";
        dataStrings.forEach((text, i) => {
            const div = document.createElement('div');
            div.className = "res-block";
            div.innerHTML = `<span class="res-title">${d.res_t[i] || "Result"}</span><div class="res-value">${text}</div>`;
            container.appendChild(div);
        });
        addAIBtn(container);
        container.style.display = "block";
    }

    function addAIBtn(container) {
        const d = translations[activeLang] || translations['en'];
        const aiBtn = document.createElement('button');
        aiBtn.className = "ai-btn";
        aiBtn.innerHTML = `<div class="spinner"></div><span class="btn-label">${d.lbl.ai_btn}</span>`;
        aiBtn.onclick = () => getAIAnalysis();
        container.appendChild(aiBtn);

        const aiBlock = document.createElement('div');
        aiBlock.id = `ai-box`;
        aiBlock.className = "ai-block";
        aiBlock.innerHTML = `<span class="ai-title">${d.lbl.ai_title}</span><div class="res-value" id="ai-val">...</div>`;
        container.appendChild(aiBlock);
    }

    function getAIAnalysis() {
        const d = translations[activeLang] || translations['en'];
        const aiVal = document.getElementById('ai-val');
        const aiBox = document.getElementById('ai-box');
        aiBox.style.display = "block";
        aiVal.innerText = d.lbl.soon;
    }

    function filterTools() {
        refreshSidebar(document.getElementById('search').value);
    }

    refreshSidebar();
    renderActiveTool();
</script>
</body>
</html>
