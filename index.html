<!DOCTYPE html>
<html lang="sr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shocking Math | Human Metrics Hub</title>
    <style>
        :root {
            --primary: #00ff88;
            --bg: #0b0f1a;
            --card: #161b2a;
            --text: #f8fafc;
            --sidebar-w: 280px;
            --accent: #3b82f6;
        }

        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: var(--bg);
            color: var(--text);
            margin: 0;
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* Sidebar - Desktop */
        .sidebar {
            width: var(--sidebar-w);
            background: var(--card);
            border-right: 1px solid #2d334a;
            display: flex; flex-direction: column;
            padding: 25px; flex-shrink: 0; z-index: 100;
        }

        .logo {
            font-size: 1.4rem; font-weight: 900; color: var(--primary);
            margin-bottom: 25px; letter-spacing: -1px;
            display: flex; align-items: center; gap: 10px;
        }

        .search-box {
            padding: 12px; background: var(--bg); border: 1px solid #2d334a;
            border-radius: 10px; color: white; margin-bottom: 20px;
            width: 100%; box-sizing: border-box; outline: none; font-size: 0.85rem;
        }

        .nav-list {
            list-style: none; padding: 0; margin: 0;
            overflow-y: auto; flex-grow: 1;
        }

        .nav-item {
            padding: 10px 14px; border-radius: 10px; cursor: pointer;
            margin-bottom: 6px; transition: all 0.2s ease;
            font-size: 0.85rem; color: #94a3b8;
            display: flex; align-items: center; gap: 10px;
        }

        .nav-item:hover { background: rgba(0, 255, 136, 0.05); color: white; }
        .nav-item.active {
            background: var(--primary); color: #000; font-weight: 700;
        }

        /* Mobile Header */
        .mobile-header {
            display: none;
            width: 100%;
            background: var(--card);
            padding: 10px 15px;
            border-bottom: 1px solid #2d334a;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1000;
            box-sizing: border-box;
            flex-direction: column;
            gap: 10px;
        }

        .mobile-top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }

        .mobile-tool-select {
            background: var(--bg);
            color: var(--primary);
            border: 1px solid var(--primary);
            padding: 10px;
            border-radius: 10px;
            font-size: 0.95rem;
            outline: none;
            width: 100%;
            font-weight: 600;
        }

        /* Main Content */
        .main-content {
            flex-grow: 1; display: flex; flex-direction: column;
            align-items: center; justify-content: flex-start;
            padding: 40px 20px; overflow-y: auto; position: relative;
        }

        .lang-bar {
            display: flex; gap: 5px;
        }

        /* Desktop position for lang-bar */
        .sidebar .lang-bar {
            margin-top: auto;
            padding-top: 20px;
            border-top: 1px solid #2d334a;
        }

        .lang-btn {
            background: var(--card); border: 1px solid #2d334a; color: white;
            padding: 6px 10px; border-radius: 8px; cursor: pointer;
            font-size: 0.75rem; font-weight: 600; flex: 1;
            text-align: center;
        }

        .lang-btn.active { border-color: var(--primary); color: var(--primary); background: rgba(0, 255, 136, 0.1); }

        .tool-card {
            background: var(--card); padding: 30px; border-radius: 24px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.4); width: 100%;
            max-width: 600px; border: 1px solid #2d334a;
            margin-bottom: 40px;
        }

        h2 { margin: 0 0 10px 0; font-size: 1.5rem; display: flex; align-items: center; gap: 10px; }
        .tool-desc { color: #64748b; font-size: 0.85rem; margin-bottom: 25px; line-height: 1.4; }

        .input-row { display: flex; gap: 15px; margin-bottom: 15px; flex-wrap: wrap; }
        .input-group { flex: 1; min-width: 140px; }

        label {
            display: block; margin-bottom: 8px; font-size: 0.7rem;
            color: #64748b; text-transform: uppercase; font-weight: 800;
        }

        input {
            width: 100%; padding: 12px; background: var(--bg);
            border: 1px solid #2d334a; border-radius: 10px; color: white;
            font-size: 0.95rem; box-sizing: border-box;
        }

        input:focus { border-color: var(--primary); outline: none; }

        .calc-btn {
            width: 100%; padding: 16px; background: var(--primary);
            color: #000; border: none; border-radius: 12px; font-weight: 800;
            cursor: pointer; text-transform: uppercase; font-size: 0.9rem; margin-top: 10px;
        }

        .ai-btn {
            background: var(--accent); color: white; padding: 18px;
            border-radius: 14px; font-weight: 800; border: none; cursor: pointer;
            display: flex; align-items: center; justify-content: center; gap: 12px; 
            margin-top: 20px; width: 100%; font-size: 1.1rem;
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.3);
            transition: transform 0.2s ease;
        }

        .ai-btn:active { transform: scale(0.98); }

        .result-container { margin-top: 30px; display: none; width: 100%; }
        .res-block {
            background: rgba(255,255,255,0.02); border-radius: 16px;
            padding: 18px; margin-bottom: 12px; border: 1px solid rgba(255,255,255,0.05);
        }

        .ai-block {
            background: rgba(59, 130, 246, 0.05); border: 1px solid var(--accent);
            border-left-width: 4px; padding: 18px; border-radius: 16px;
            margin-top: 15px; display: none;
        }

        .res-title { color: var(--primary); font-size: 0.65rem; font-weight: 900; text-transform: uppercase; margin-bottom: 5px; display: block; }
        .res-value { font-size: 1rem; font-weight: 500; line-height: 1.5; }
        .highlight { color: var(--primary); font-weight: 800; }

        .spinner {
            width: 22px; height: 22px; border: 3px solid rgba(255,255,255,0.3);
            border-top: 3px solid white; border-radius: 50%; animation: spin 1s linear infinite; display: none;
        }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        /* Responsive UI */
        @media (max-width: 850px) {
            .sidebar { display: none; }
            .mobile-header { display: flex; }
            .main-content { padding-top: 120px; padding-left: 15px; padding-right: 15px; height: auto; overflow: visible; }
            body { height: auto; overflow-y: auto; }
            .tool-card { padding: 20px; margin-top: 0; }
        }
    </style>
</head>
<body>

    <!-- Mobile Header -->
    <header class="mobile-header">
        <div class="mobile-top-bar">
            <div class="logo" style="margin:0; font-size: 1.1rem;">SHOCKING MATH ‚ö°</div>
            <div class="lang-bar" id="mobile-lang-bar">
                <button class="lang-btn active" onclick="changeLang('en')">EN</button>
                <button class="lang-btn" onclick="changeLang('sr')">SR</button>
                <button class="lang-btn" onclick="changeLang('de')">DE</button>
                <button class="lang-btn" onclick="changeLang('fr')">FR</button>
            </div>
        </div>
        <select class="mobile-tool-select" id="mobile-nav" onchange="selectMobileTool(this.value)"></select>
    </header>

    <!-- Desktop Sidebar -->
    <aside class="sidebar">
        <div class="logo">SHOCKING MATH ‚ö°</div>
        <input type="text" class="search-box" id="search" placeholder="Pretra≈æi..." onkeyup="filterTools()">
        <ul class="nav-list" id="nav-list"></ul>
        <div class="lang-bar">
            <button class="lang-btn active" onclick="changeLang('en')">EN</button>
            <button class="lang-btn" onclick="changeLang('sr')">SR</button>
            <button class="lang-btn" onclick="changeLang('de')">DE</button>
            <button class="lang-btn" onclick="changeLang('fr')">FR</button>
        </div>
    </aside>

    <main class="main-content">
        <div id="tool-view" style="width: 100%; display: flex; justify-content: center;"></div>
    </main>

<script>
    // --- UPUTSTVO ZA AI ---
    // Tvoj API kljuƒç je ubaƒçen ispod.
    const apiKey = "AIzaSyCmVM7ocA_FhZ0tUFxPfQiDTD0dB4JBlc0"; 

    let activeLang = 'en';
    let activeTool = "human";

    const toolDefinitions = [
        { id: "human", emoji: "üë§", inputs: ["age"] },
        { id: "oxygen", emoji: "üå¨Ô∏è", inputs: ["age"] },
        { id: "scroll", emoji: "üì±", inputs: ["age", "start", "hours"] },
        { id: "coffee", emoji: "‚òï", inputs: ["age", "start", "daily"] },
        { id: "perfume", emoji: "üß¥", inputs: ["size", "price", "sprays", "freq"] },
        { id: "exam", emoji: "üìö", inputs: ["pages", "pph", "hours"] },
        { id: "toilet", emoji: "üöΩ", inputs: ["min", "daily"] },
        { id: "sleep", emoji: "üò¥", inputs: ["shours"] },
        { id: "books", emoji: "üìñ", inputs: ["pday"] },
        { id: "bezos", emoji: "üí∞", inputs: ["salary"] },
        { id: "pizza", emoji: "üçï", inputs: ["monthly"] },
        { id: "commute", emoji: "üöó", inputs: ["chours", "cyears"] },
        { id: "words", emoji: "üó£Ô∏è", inputs: ["age"] },
        { id: "sitting", emoji: "ü™ë", inputs: ["shours_day", "syears"] },
        { id: "waiting", emoji: "‚è≥", inputs: ["age"] }
    ];

    const translations = {
        en: {
            nav: ["Human Body Stats", "Oxygen Factory", "Scroll Everest", "Coffee Ocean", "Perfume Value", "Exam Timer", "Toilet Warp", "Sleep Debt", "Book Worm", "Bezos vs You", "Pizza Surface", "Commute Life", "Words Library", "Sitting Life", "Waiting Line"],
            h: ["Human Body Facts", "Oxygen Factory", "Scroll Distance", "Coffee Ocean", "Perfume Value", "Exam Prep", "Toilet Time", "Sleep Debt", "Book Worm", "The Bezos Gap", "Pizza Surface", "Traffic Trap", "Talking Library", "The Chair Trap", "Queue Specialist"],
            d: ["Biological impact of your existence.", "Amount of oxygen you've consumed and CO2 produced.", "Vertical distance you've scrolled.", "The literal ocean of caffeine consumed.", "True cost of smelling good.", "Study sessions based on volume.", "Life spent on the porcelain throne.", "Cost of staying awake vs rest.", "Knowledge volume in books.", "Billionaire vs your annual wage.", "Total surface of dough eaten.", "Time lost in traffic jams.", "Library of words you've spoken.", "Impact of a sedentary lifestyle.", "Time spent waiting in queues."],
            lbl: {
                age: "Age", start: "Started at", hours: "Hours/Day", daily: "Times/Day", size: "Size (ml)", price: "Price (‚Ç¨)",
                sprays: "Sprays", freq: "Days/Week", pages: "Pages", pph: "Pages/h", min: "Min/Session",
                shours: "Sleep Hours", pday: "Pages/Day", monthly: "Pizzas/Month", salary: "Salary (‚Ç¨)", 
                chours: "Hours/Day", cyears: "Years", shours_day: "Hours Sitting", syears: "Years",
                btn: "Calculate üöÄ", ai_btn: "Get ‚ú® AI Insight", ai_loading: "Analyzing...", ai_title: "AI Analysis ‚ú®"
            },
            res_t: ["The Shock üò±", "The Math üìä"],
            ai_prompt: "Act as a sarcastic data analyst. Analyze my {type} stats: {result}. Short & funny in {lang}.",
            facts: ["Heartbeat", "Breaths", "Hair", "Feces", "Urine", "Skin"],
            units: ["beats", "times", "km", "kg", "L", "kg"],
            ofacts: ["Oxygen Consumed", "CO2 Produced", "Trees Required"],
            ounits: ["liters", "kg", "trees"]
        },
        sr: {
            nav: ["Ljudsko telo", "Fabrika kiseonika", "Scroll Everest", "Okean kafe", "Cena parfema", "Ispit tajmer", "WC vreme", "Dug spavanja", "ƒåitaƒç knjiga", "Bezos i ti", "Povr≈°ina pice", "≈Ωivot u putu", "Biblioteka reƒçi", "≈Ωivot u stolici", "Red ƒçekanja"],
            h: ["ƒåinjenice o telu", "Fabrika kiseonika", "Scroll kilometra≈æa", "Okean kafe", "Vrednost parfema", "Spremanje ispita", "WC vremenska ma≈°ina", "Dug spavanja", "ƒåitaƒç knjiga", "Bezosov ponor", "Povr≈°ina pice", "Zemlja u gu≈ævi", "Govorna biblioteka", "Zamka stolice", "Specijalista za redove"],
            d: ["Izraƒçunaj svoj biolo≈°ki uticaj do sada.", "Koliƒçina kiseonika koju si potro≈°io i CO2 koji si proizveo.", "Koliko si visoko skrolovao vertikalno.", "Doslovni okean kofeina koji si popio.", "Prava cena tvog dobrog mirisa.", "Isplaniraj uƒçenje na osnovu strana.", "Vreme provedeno na porcelanskom tronu.", "Cena nespavanja u odnosu na odmor.", "Zapremina znanja u knjigama.", "Koliko brzo Bezos zaradi tvoju platu.", "Ukupna povr≈°ina testa koju si pojeo.", "Vreme izgubljeno u saobraƒáaju.", "Biblioteka reƒçi koje si izgovorio.", "Fiziƒçki uticaj sedenja.", "Vreme provedeno u redovima."],
            lbl: {
                age: "Godine", start: "Poƒçeo sa", hours: "Sati dnevno", daily: "Dnevno puta", size: "Veliƒçina (ml)", price: "Cena (‚Ç¨)",
                sprays: "Prskanja", freq: "Dana/Nedeljno", pages: "Ukupno strana", pph: "Strana/h", min: "Min/Sesiji",
                shours: "Sati sna", pday: "Strana/Dan", monthly: "Pica meseƒçno", salary: "Plata (‚Ç¨)",
                chours: "Sati/Dan", cyears: "Godina puta", shours_day: "Sati sedenja", syears: "Godina sedenja",
                btn: "Izraƒçunaj üöÄ", ai_btn: "Zatra≈æi ‚ú® AI Uvid", ai_loading: "Analiziram...", ai_title: "AI Analiza ‚ú®"
            },
            res_t: ["≈†ok podatak üò±", "Matematika üìä"],
            ai_prompt: "Pona≈°aj se kao sarkastiƒçan analitiƒçar. Analiziraj statistiku: {type}: {result}. Budi kratak i duhovit na srpskom jeziku.",
            facts: ["Otkucaji srca", "Udisaji", "Rast kose", "Izmet", "Urin", "Mrtva ko≈æa"],
            units: ["otkucaja", "puta", "km", "kg", "L", "kg"],
            ofacts: ["Potro≈°en kiseonik", "Proizveden CO2", "Potrebno drveƒáa"],
            ounits: ["litara", "kg", "stabala"]
        },
        de: {
            nav: ["K√∂rper Statistiken", "Sauerstofffabrik", "Scroll Everest", "Kaffee Ozean", "Parf√ºm Wert", "Pr√ºfung Timer", "Toilette Warp", "Schlafschulden", "B√ºcherwurm", "Bezos vs Sie", "Pizza-Fl√§che", "Pendlerleben", "Sprachbibliothek", "Sitzfalle", "Schlangestehen"],
            h: ["K√∂rperfakten", "Sauerstofffabrik", "Scroll-Distanz", "Kaffee-Ozean", "Parf√ºm-Wert", "Pr√ºfungsvorbereitung", "Toiletten-Warp", "Schlafschulden", "B√ºcherwurm", "Bezos-L√ºcke", "Pizza-Oberfl√§che", "Verkehrsfalle", "Sprechbibliothek", "Sitzfalle", "Schlangestehen"],
            d: ["Biologische Auswirkungen Ihrer Existenz.", "Menge an verbrauchtem Sauerstoff und produziertem CO2.", "Vertikale Distanz, die Sie gescrollt haben.", "Literaler Ozean an konsumiertem Koffein.", "Wahre Kosten f√ºr guten Duft.", "Lernsitzungen basierend auf Volumen.", "Leben auf dem Porzellanthron.", "Kosten des Wachbleibens vs. Ruhe.", "Wissensvolumen in B√ºchern.", "Milliard√§r vs. Ihr Jahreslohn.", "Gesamtfl√§che an verzehrtem Teig.", "Zeitverlust im Stau.", "Bibliothek der gesprochenen W√∂rter.", "Auswirkungen eines sitzenden Lebensstils.", "Wartezeit in Warteschlangen."],
            lbl: { age: "Alter", start: "Begonnen", hours: "Std/Tag", daily: "T√§glich", size: "Gr√∂√üe (ml)", price: "Preis (‚Ç¨)", sprays: "Sprays", freq: "Tage/Woche", pages: "Seiten", pph: "Seiten/h", min: "Min/Sitzung", shours: "Schlafstd.", pday: "Seiten/Tag", monthly: "Pizza/Monat", salary: "Gehalt (‚Ç¨)", chours: "Std/Tag", cyears: "Jahre", shours_day: "Std/Tag", syears: "Jahre", btn: "Berechnen üöÄ", ai_btn: "AI-Einblick ‚ú®", ai_loading: "Analyse...", ai_title: "AI Analyse ‚ú®" },
            res_t: ["Schock-Faktor üò±", "Mathematik üìä"],
            facts: ["Herzschlag", "Atemz√ºge", "Haarwuchs", "F√§kalien", "Urin", "Haut"],
            units: ["Schl√§ge", "Mal", "km", "kg", "L", "kg"],
            ofacts: ["Verbrauchter Sauerstoff", "Produziertes CO2", "Ben√∂tigte B√§ume"],
            ounits: ["Liter", "kg", "B√§ume"]
        },
        fr: {
            nav: ["Stats Corps", "Usine Oxyg√®ne", "Scroll Everest", "Oc√©an Caf√©", "Valeur Parfum", "Exam Timer", "Toilette Warp", "Dette Sommeil", "Lecteur Livre", "Ecart Bezos", "Surface Pizza", "Vie Trajets", "Biblioth√®que Mots", "Vie Assise", "File d'attente"],
            h: ["Faits Biologiques", "Usine √† Oxyg√®ne", "Distance Scroll", "Oc√©an de Caf√©", "Valeur Parfum", "Pr√©paration Exam", "Temps Toilette", "Dette Sommeil", "Lecteur de Livre", "Ecart Bezos", "Surface Pizza", "Pi√®ge Trafic", "Biblioth√®que Parl√©e", "Pi√®ge Assis", "Sp√©cialiste File"],
            d: ["Impact biologique de votre existence.", "Quantit√© d'oxyg√®ne consomm√©e et de CO2 produit.", "Distance verticale scroll√©e.", "Oc√©an de caf√©ine consomm√©.", "Co√ªt r√©el pour sentir bon.", "Sessions d'√©tude par volume.", "Vie sur le tr√¥ne de porcelaine.", "Co√ªt de l'√©veil vs repos.", "Volume de connaissances en livres.", "Milliardaire vs votre salaire annuel.", "Surface totale de p√¢te mang√©e.", "Temps perdu dans les bouchons.", "Biblioth√®que de mots parl√©s.", "Impact de la s√©dentarit√©.", "Temps pass√© dans les files."],
            lbl: { age: "√Çge", start: "Commenc√©", hours: "Heures/jour", daily: "Par jour", size: "Taille (ml)", price: "Prix (‚Ç¨)", sprays: "Sprays", freq: "Jours/sem", pages: "Pages", pph: "Pages/h", min: "Min/session", shours: "Sommeil", pday: "Pages/jour", monthly: "Pizzas/mois", salary: "Salaire (‚Ç¨)", chours: "Heures/jour", cyears: "Ann√©es", shours_day: "Heures/jour", syears: "Ann√©es", btn: "Calculer üöÄ", ai_btn: "Aper√ßu AI ‚ú®", ai_loading: "Analyse...", ai_title: "Analyse AI ‚ú®" },
            res_t: ["Le Choc üò±", "Calcul üìä"],
            facts: ["Battements", "Souffles", "Cheveux", "Excr√©ments", "Urine", "Peau"],
            units: ["battements", "fois", "km", "kg", "L", "kg"],
            ofacts: ["Oxyg√®ne consomm√©", "CO2 produit", "Arbres requis"],
            ounits: ["litres", "kg", "arbres"]
        }
    };

    function formatNumber(n) {
        return new Intl.NumberFormat('de-DE').format(Math.floor(n));
    }

    function handleInput(e) {
        let val = e.target.value.replace(/\D/g, "");
        if (val === "") { e.target.value = ""; return; }
        e.target.value = new Intl.NumberFormat('de-DE').format(parseInt(val));
    }

    function getRawValue(id) {
        const el = document.getElementById(id);
        return el ? parseFloat(el.value.replace(/\./g, "")) || 0 : 0;
    }

    function changeLang(l) {
        activeLang = l;
        document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.lang-btn').forEach(b => {
            if (b.innerText.toLowerCase() === l) b.classList.add('active');
        });
        refreshSidebar();
        renderActiveTool();
    }

    function selectMobileTool(val) {
        activeTool = val;
        refreshSidebar();
        renderActiveTool();
    }

    function refreshSidebar(filter = "") {
        const d = translations[activeLang] || translations['en'];
        const list = document.getElementById('nav-list');
        const mobileNav = document.getElementById('mobile-nav');
        
        list.innerHTML = "";
        mobileNav.innerHTML = "";

        toolDefinitions.forEach((tool, i) => {
            const name = d.nav[i];
            if (name.toLowerCase().includes(filter.toLowerCase())) {
                const li = document.createElement('li');
                li.className = `nav-item ${tool.id === activeTool ? 'active' : ''}`;
                li.innerHTML = `<span>${tool.emoji}</span> ${name}`;
                li.onclick = () => { activeTool = tool.id; refreshSidebar(filter); renderActiveTool(); };
                list.appendChild(li);
            }
            const opt = document.createElement('option');
            opt.value = tool.id;
            opt.innerText = `${tool.emoji} ${name}`;
            opt.selected = tool.id === activeTool;
            mobileNav.appendChild(opt);
        });
    }

    function renderActiveTool() {
        const toolIdx = toolDefinitions.findIndex(t => t.id === activeTool);
        const tool = toolDefinitions[toolIdx];
        const d = translations[activeLang] || translations['en'];
        const view = document.getElementById('tool-view');
        
        let inputsHtml = "";
        for (let i = 0; i < tool.inputs.length; i += 2) {
            inputsHtml += '<div class="input-row">';
            for (let j = 0; j < 2 && (i + j) < tool.inputs.length; j++) {
                const key = tool.inputs[i+j];
                inputsHtml += `<div class="input-group"><label>${d.lbl[key]}</label><input type="text" id="in-${key}" value="${formatNumber(getDefaultValue(key))}" oninput="handleInput(event)"></div>`;
            }
            inputsHtml += '</div>';
        }

        view.innerHTML = `
            <div class="tool-card active">
                <h2>${tool.emoji} ${d.h[toolIdx]}</h2>
                <p class="tool-desc">${d.d[toolIdx]}</p>
                ${inputsHtml}
                <button class="calc-btn" onclick="runCalculation()">${d.lbl.btn}</button>
                <div class="result-container" id="res-box"></div>
            </div>
        `;
    }

    function getDefaultValue(key) {
        const defaults = { age: 25, start: 14, hours: 4, daily: 2, size: 100, price: 150, sprays: 5, freq: 7, pages: 300, pph: 6, min: 20, shours: 6, pday: 25, monthly: 4, salary: 45000, chours: 1, cyears: 15, shours_day: 8, syears: 10 };
        return defaults[key] || 0;
    }

    function runCalculation() {
        const d = translations[activeLang] || translations['en'];
        const vals = {};
        const tool = toolDefinitions.find(t => t.id === activeTool);
        tool.inputs.forEach(id => { vals[id] = getRawValue(`in-${id}`); });

        if (activeTool === 'human') {
            const age = vals.age || 1;
            const heart = age * 365.25 * 24 * 60 * 75;
            const feces = age * 365.25 * 0.128;
            const urine = age * 365.25 * 1.5;
            const hair = age * 365.25 * 0.35 * 100000 / 1000000;
            const breaths = age * 365.25 * 24 * 60 * 14;
            const skin = age * 0.8;

            const facts = [
                { icon: "‚ù§Ô∏è", label: d.facts[0], value: formatNumber(heart), unit: d.units[0] },
                { icon: "üå¨Ô∏è", label: d.facts[1], value: formatNumber(breaths), unit: d.units[1] },
                { icon: "üíá", label: d.facts[2], value: hair.toFixed(1), unit: d.units[2] },
                { icon: "üí©", label: d.facts[3], value: formatNumber(feces), unit: d.units[3] },
                { icon: "üß™", label: d.facts[4], value: formatNumber(urine), unit: d.units[4] },
                { icon: "üêç", label: d.facts[5], value: skin.toFixed(1), unit: d.units[5] }
            ];
            renderHumanResults(facts);
            return;
        }

        if (activeTool === 'oxygen') {
            const age = vals.age || 1;
            const o2 = age * 365.25 * 550; // Liters O2 per day avg
            const co2 = age * 365.25 * 1.0; // kg CO2 per day avg
            const trees = Math.ceil(co2 / 22); // One tree absorbs 22kg/year

            const facts = [
                { icon: "ü´Å", label: d.ofacts[0], value: formatNumber(o2), unit: d.ounits[0] },
                { icon: "üè≠", label: d.ofacts[1], value: formatNumber(co2), unit: d.ounits[1] },
                { icon: "üå≥", label: d.ofacts[2], value: formatNumber(trees), unit: d.ounits[2] }
            ];
            renderHumanResults(facts);
            return;
        }

        const years = Math.max(0, vals.age - (vals.start || 0));

        // Multi-language results templates
        const resMsg = {
            en: {
                scroll: [`You scrolled <span class="highlight">${formatNumber(vals.hours * 0.18 * 365.25 * years)} km</span>. That's <span class="highlight">${((vals.hours * 0.18 * 365.25 * years) / 8.848).toFixed(1)} Mt. Everests</span>!`, `0.18km/h speed across ${years} years.`],
                coffee: [`You drank <span class="highlight">${formatNumber(Math.floor(vals.daily * 0.18 * 365.25 * years))} liters</span>. That's <span class="highlight">${(Math.floor(vals.daily * 0.18 * 365.25 * years) / 150).toFixed(1)} bathtubs</span>!`, `180ml cup across ${years} years.`],
                perfume: [`1 spray costs <span class="highlight">${(vals.price / (vals.size * 10 || 1)).toFixed(2)} ‚Ç¨</span>. Bottle lasts <span class="highlight">${formatNumber(Math.floor((vals.size * 10) / (vals.sprays * (vals.freq/7) || 1)))} days</span>.`, `Based on 10 sprays per 1ml.`],
                bezos: [`Bezos earns your salary in <span class="highlight">${(vals.salary / 2200).toFixed(2)} seconds</span>.`, `Estimated ~2.200 ‚Ç¨ earning per second.`],
                pizza: [`You eat <span class="highlight">${(vals.monthly * 12 * 0.07).toFixed(2)} m¬≤</span> of pizza per year.`, `Average pizza is 0.07m¬≤.`],
                sleep: [`You lose <span class="highlight">${((8 - vals.shours) * 365.25 / 24).toFixed(1)} days</span> of recovery per year.`, `Against 8h optimal sleep daily.`],
                exam: [`You need <span class="highlight">${((vals.pages / (vals.pph || 1)) / (vals.hours || 1)).toFixed(1)} days</span>. Total: <span class="highlight">${(vals.pages / (vals.pph || 1)).toFixed(1)} hours</span>.`, `${formatNumber(vals.pages)} pages at ${vals.pph} str/h.`],
                toilet: [`In 40 years, you'll spend <span class="highlight">${formatNumber(Math.floor((vals.min * vals.daily * 365.25 * 40) / 1440))} days</span> on the throne.`, `Based on your habits.`],
                words: [`Spoken equivalent to <span class="highlight">${formatNumber(Math.floor((vals.age * 365.25 * 7000) / 50000))}</span> thick books.`, `Avg 7.000 words per day.`],
                sitting: [`Spent <span class="highlight">${(vals.shours_day * 365.25 * vals.syears / 8760).toFixed(1)} years</span> sitting.`, `Converted to full years.`],
                waiting: [`Spent <span class="highlight">${formatNumber(Math.floor(vals.age * 3.5))} days</span> in lines.`, `Est. 3.5 days/year waiting.`],
                commute: [`Spent <span class="highlight">${formatNumber(Math.floor((vals.chours * 250 * vals.cyears) / 24))} days</span> in traffic.`, `Based on 250 work days/year.`]
            },
            sr: {
                scroll: [`Skrolovao si <span class="highlight">${formatNumber(vals.hours * 0.18 * 365.25 * years)} km</span>. To je visina <span class="highlight">${((vals.hours * 0.18 * 365.25 * years) / 8.848).toFixed(1)} Mont Everesta</span>!`, `Brzina 0.18km/h tokom ${years} godina.`],
                coffee: [`Popio si <span class="highlight">${formatNumber(Math.floor(vals.daily * 0.18 * 365.25 * years))} litara</span>. To puni <span class="highlight">${(Math.floor(vals.daily * 0.18 * 365.25 * years) / 150).toFixed(1)} kadi</span>!`, `180ml po ≈°olji tokom ${years} god.`],
                perfume: [`Jedno prskanje ko≈°ta <span class="highlight">${(vals.price / (vals.size * 10 || 1)).toFixed(2)} ‚Ç¨</span>. Boƒçica traje <span class="highlight">${formatNumber(Math.floor((vals.size * 10) / (vals.sprays * (vals.freq/7) || 1)))} dana</span>.`, `Na bazi 10 prskanja po 1ml.`],
                bezos: [`Bezos zaradi tvoju platu za <span class="highlight">${(vals.salary / 2200).toFixed(2)} sekundi</span>.`, `Procenjeno ~2.200 ‚Ç¨ u sekundi.`],
                pizza: [`Pojeo si <span class="highlight">${(vals.monthly * 12 * 0.07).toFixed(2)} m¬≤</span> pice godi≈°nje.`, `Proseƒçna pica je 0.07m¬≤.`],
                sleep: [`Gubi≈° <span class="highlight">${((8 - vals.shours) * 365.25 / 24).toFixed(1)} dana</span> odmora godi≈°nje.`, `U odnosu na idealnih 8h sna.`],
                exam: [`Treba ti <span class="highlight">${((vals.pages / (vals.pph || 1)) / (vals.hours || 1)).toFixed(1)} dana</span>. Ukupno: <span class="highlight">${(vals.pages / (vals.pph || 1)).toFixed(1)} sati</span>.`, `${formatNumber(vals.pages)} strana pri ${vals.pph} str/h.`],
                toilet: [`U 40 godina prove≈°ƒáe≈° <span class="highlight">${formatNumber(Math.floor((vals.min * vals.daily * 365.25 * 40) / 1440))} dana</span> na ≈°olji.`, `Bazirano na tvojim navikama.`],
                words: [`Izgovorio si reƒçi za <span class="highlight">${formatNumber(Math.floor((vals.age * 365.25 * 7000) / 50000))}</span> knjiga.`, `Prosek od 7.000 reƒçi dnevno.`],
                sitting: [`Proveo si <span class="highlight">${(vals.shours_day * 365.25 * vals.syears / 8760).toFixed(1)} godina</span> sedeƒái.`, `Pretvoreno u pune godine.`],
                waiting: [`ƒåekao si u redovima ukupno <span class="highlight">${formatNumber(Math.floor(vals.age * 3.5))} dana</span>.`, `Procena 3.5 dana godi≈°nje.`],
                commute: [`Proveo si <span class="highlight">${formatNumber(Math.floor((vals.chours * 250 * vals.cyears) / 24))} dana</span> u putu.`, `Na bazi 250 radnih dana godi≈°nje.`]
            },
            de: {
                scroll: [`Du hast <span class="highlight">${formatNumber(vals.hours * 0.18 * 365.25 * years)} km</span> gescrollt. Das sind <span class="highlight">${((vals.hours * 0.18 * 365.25 * years) / 8.848).toFixed(1)} Mt. Everests</span>!`, `Geschwindigkeit 0.18km/h √ºber ${years} Jahre.`],
                coffee: [`Du hast <span class="highlight">${formatNumber(Math.floor(vals.daily * 0.18 * 365.25 * years))} Liter</span> Kaffee getrunken. Das f√ºllt <span class="highlight">${(Math.floor(vals.daily * 0.18 * 365.25 * years) / 150).toFixed(1)} Badewannen</span>!`, `Basierend auf 180ml/Tasse √ºber ${years} Jahre.`],
                perfume: [`Ein Spr√ºhsto√ü kostet <span class="highlight">${(vals.price / (vals.size * 10 || 1)).toFixed(2)} ‚Ç¨</span>. Die Flasche h√§lt <span class="highlight">${formatNumber(Math.floor((vals.size * 10) / (vals.sprays * (vals.freq/7) || 1)))} Tage</span>.`, `Basierend auf 10 Sprays/ml.`],
                bezos: [`Bezos verdient dein Jahresgehalt in <span class="highlight">${(vals.salary / 2200).toFixed(2)} Sekunden</span>.`, `Gesch√§tzt ~2.200 ‚Ç¨ pro Sekunde.`],
                pizza: [`Du isst <span class="highlight">${(vals.monthly * 12 * 0.07).toFixed(2)} m¬≤</span> Pizza pro Jahr.`, `Durchschnittliche Pizzafl√§che: 0.07m¬≤.`],
                sleep: [`Du verlierst <span class="highlight">${((8 - vals.shours) * 365.25 / 24).toFixed(1)} Tage</span> Regeneration pro Jahr.`, `Gegen√ºber 8 Stunden Schlaf pro Nacht.`],
                exam: [`Du brauchst <span class="highlight">${((vals.pages / (vals.pph || 1)) / (vals.hours || 1)).toFixed(1)} Tage</span>. Gesamt: <span class="highlight">${(vals.pages / (vals.pph || 1)).toFixed(1)} Stunden</span>.`, `${formatNumber(vals.pages)} Seiten bei ${vals.pph} S/h.`],
                toilet: [`In 40 Jahren verbringst du <span class="highlight">${formatNumber(Math.floor((vals.min * vals.daily * 365.25 * 40) / 1440))} Tage</span> im Bad.`, `Basierend auf deinen Gewohnheiten.`],
                words: [`Gesprochene W√∂rter entsprechen <span class="highlight">${formatNumber(Math.floor((vals.age * 365.25 * 7000) / 50000))}</span> B√ºchern.`, `Durchschnittlich 7.000 W√∂rter pro Tag.`],
                sitting: [`Du sa√üt insgesamt <span class="highlight">${(vals.shours_day * 365.25 * vals.syears / 8760).toFixed(1)} Jahre</span>.`, `In volle Kalenderjahre umgerechnet.`],
                waiting: [`Du hast insgesamt <span class="highlight">${formatNumber(Math.floor(vals.age * 3.5))} Tage</span> in Warteschlangen gewartet.`, `√ò 3.5 Tage/Jahr Wartezeit.`],
                commute: [`Du hast insgesamt <span class="highlight">${formatNumber(Math.floor((vals.chours * 250 * vals.cyears) / 24))} Tage</span> im Stau verbracht.`, `Basierend auf 250 Arbeitstagen pro Jahr.`]
            },
            fr: {
                scroll: [`Vous avez scroll√© <span class="highlight">${formatNumber(vals.hours * 0.18 * 365.25 * years)} km</span>. C'est l'√©quivalent de <span class="highlight">${((vals.hours * 0.18 * 365.25 * years) / 8.848).toFixed(1)} Mont Everests</span>!`, `Vitesse 0.18km/h sur ${years} ans.`],
                coffee: [`Vous avez bu <span class="highlight">${formatNumber(Math.floor(vals.daily * 0.18 * 365.25 * years))} litres</span> de caf√©. C'est <span class="highlight">${(Math.floor(vals.daily * 0.18 * 365.25 * years) / 150).toFixed(1)} baignoires</span>!`, `Tasse de 180ml sur ${years} ans.`],
                perfume: [`Un spray co√ªte <span class="highlight">${(vals.price / (vals.size * 10 || 1)).toFixed(2)} ‚Ç¨</span>. Le flacon dure <span class="highlight">${formatNumber(Math.floor((vals.size * 10) / (vals.sprays * (vals.freq/7) || 1)))} jours</span>.`, `Bas√© sur 10 sprays par ml.`],
                bezos: [`Bezos gagne votre salaire annuel en <span class="highlight">${(vals.salary / 2200).toFixed(2)} secondes</span>.`, `Estimation ~2.200 ‚Ç¨ par seconde.`],
                pizza: [`Vous mangez <span class="highlight">${(vals.monthly * 12 * 0.07).toFixed(2)} m¬≤</span> de pizza par an.`, `Surface moyenne de pizza : 0.07m¬≤.`],
                sleep: [`Vous perdez <span class="highlight">${((8 - vals.shours) * 365.25 / 24).toFixed(1)} jours</span> de repos par an.`, `Contre 8h de sommeil id√©al par nuit.`],
                exam: [`Besoin de <span class="highlight">${((vals.pages / (vals.pph || 1)) / (vals.hours || 1)).toFixed(1)} jours</span>. Total: <span class="highlight">${(vals.pages / (vals.pph || 1)).toFixed(1)} heures</span>.`, `${formatNumber(vals.pages)} pages √† ${vals.pph} p/h.`],
                toilet: [`En 40 ans, vous passerez <span class="highlight">${formatNumber(Math.floor((vals.min * vals.daily * 365.25 * 40) / 1440))} jours</span> aux toilettes.`, `Bas√© sur vos habitudes quotidiennes.`],
                words: [`Mots parl√©s √©quivalents √† <span class="highlight">${formatNumber(Math.floor((vals.age * 365.25 * 7000) / 50000))}</span> livres.`, `√ò 7.000 mots par jour.`],
                sitting: [`Pass√© <span class="highlight">${(vals.shours_day * 365.25 * vals.syears / 8760).toFixed(1)} ans</span> assis.`, `Converti en ann√©es calendaires pleines.`],
                waiting: [`Pass√© <span class="highlight">${formatNumber(Math.floor(vals.age * 3.5))} jours</span> √† attendre dans les files.`, `√ò 3.5 jours/an d'attente.`],
                commute: [`Pass√© <span class="highlight">${formatNumber(Math.floor((vals.chours * 250 * vals.cyears) / 24))} jours</span> dans le trafic.`, `Sur base 250 jours de travail par an.`]
            }
        };

        const langData = resMsg[activeLang] || resMsg['en'];
        const toolRes = langData[activeTool];
        renderResultsArea(activeTool, activeTool, toolRes || ["Data processed.", "Math verified."]);
    }

    function renderHumanResults(data) {
        const container = document.getElementById(`res-box`);
        container.innerHTML = "";
        data.forEach(item => {
            const div = document.createElement('div');
            div.className = "res-block";
            div.style.display = "flex"; div.style.alignItems = "center"; div.style.gap = "15px";
            div.innerHTML = `<span style="font-size: 1.5rem;">${item.icon}</span><div><span class="res-title">${item.label}</span><div class="res-value"><span class="highlight">${item.value}</span> ${item.unit}</div></div>`;
            container.appendChild(div);
        });
        addAIBtn(container, activeTool, data[0].value);
        container.style.display = "block";
    }

    function renderResultsArea(id, type, dataStrings) {
        const container = document.getElementById(`res-box`);
        const d = translations[activeLang] || translations['en'];
        container.innerHTML = "";
        dataStrings.forEach((text, i) => {
            if (!text) return;
            const div = document.createElement('div');
            div.className = "res-block";
            div.innerHTML = `<span class="res-title">${d.res_t[i] || "Result"}</span><div class="res-value">${text}</div>`;
            container.appendChild(div);
        });
        addAIBtn(container, type, dataStrings[0]);
        container.style.display = "block";
    }

    function addAIBtn(container, type, result) {
        const d = translations[activeLang] || translations['en'];
        const aiBtn = document.createElement('button');
        aiBtn.className = "ai-btn";
        aiBtn.innerHTML = `<div class="spinner"></div><span class="btn-label">${d.lbl.ai_btn}</span>`;
        aiBtn.onclick = () => getAIAnalysis(type, result);
        container.appendChild(aiBtn);

        const aiBlock = document.createElement('div');
        aiBlock.id = `ai-box`;
        aiBlock.className = "ai-block";
        aiBlock.innerHTML = `<span class="ai-title">${d.lbl.ai_title}</span><div class="res-value" id="ai-val">...</div>`;
        container.appendChild(aiBlock);
    }

    async function getAIAnalysis(type, result) {
        const d = translations[activeLang] || translations['en'];
        const btn = document.querySelector(`.ai-btn`);
        const btnLabel = btn.querySelector('.btn-label');
        const spinner = btn.querySelector('.spinner');
        const aiVal = document.getElementById('ai-val');
        const aiBox = document.getElementById('ai-box');

        btn.disabled = true; spinner.style.display = 'block';
        btnLabel.innerText = d.lbl.ai_loading;

        const prompt = d.ai_prompt.replace("{type}", type).replace("{result}", result).replace("{lang}", activeLang);
        
        const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
        try {
            const response = await fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
            });
            const data = await response.json();
            aiVal.innerText = data.candidates?.[0]?.content?.parts?.[0]?.text || "Gre≈°ka.";
            aiBox.style.display = "block";
        } catch (e) { aiVal.innerText = "Gre≈°ka u povezivanju."; aiBox.style.display = "block"; }
        
        spinner.style.display = "none";
        btnLabel.innerText = d.lbl.ai_btn; btn.disabled = false;
    }

    function filterTools() {
        refreshSidebar(document.getElementById('search').value);
    }

    refreshSidebar();
    renderActiveTool();
</script>
</body>
</html>
